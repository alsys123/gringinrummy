/*
function testMelds() {
    const message =
	  `Hey there\n\n` +
	  '';
    
    showMessage(message);
    
    return;
} // testMelds
*/

/*
  Unit testing for Melds
  
 */

/*
function testMelds() {

  // Helper to build cards
  function C(rank, suit) {
    const values = { A:1, J:10, Q:10, K:10 };
    return {
      rank,
      suit,
      value: values[rank] || Number(rank)
    };
  }

  // Test hand (run + set)
  const hand = [
    C("A","‚ô£"),  // 0
    C("2","‚ô£"),  // 1
    C("3","‚ô£"),  // 2
    C("7","‚ô•"),  // 3
    C("7","‚ô¶"),  // 4
    C("7","‚ô£"),  // 5
    C("9","‚ô†"),  // 6
    C("J","‚ô£"),  // 7
    C("4","‚ô¶"),  // 8
    C("K","‚ô•")   // 9
  ];

  // Expected melds
  const expected = [
    [0,1,2],   // run
    [3,4,5]    // set
  ];

  // Normalize helper (so ordering doesn't break tests)
  const normalize = arr =>
    arr.map(m => m.slice().sort((a,b)=>a-b))
       .sort((a,b)=>a[0]-b[0]);

  const result = normalize(getAllMeldsv2(hand));
  const expectedNorm = normalize(expected);

  const pass = JSON.stringify(result) === JSON.stringify(expectedNorm);

  const message =
    `üÉè **Meld Unit Test**\n\n` +
    `Hand: ${hand.map((c,i)=>`${i}:${c.rank}${c.suit}`).join("  ")}\n\n` +
    `Expected melds: ${JSON.stringify(expectedNorm)}\n` +
    `Got:            ${JSON.stringify(result)}\n\n` +
    `Result: **${pass ? "PASS ‚úÖ" : "FAIL ‚ùå"}**`;

  showMessage(message);
}
*/


// Helper to build cards
function C(rank, suit) {
  const values = { A:1, J:10, Q:10, K:10 };
  return {
    rank,
    suit,
    value: values[rank] || Number(rank)
  };
}

/* first example only
const meldTests = [

  {
    name: "Test 1 ‚Äî Run + Set",
    hand: [
      C("A","‚ô£"),  // 0
      C("2","‚ô£"),  // 1
      C("3","‚ô£"),  // 2
      C("7","‚ô•"),  // 3
      C("7","‚ô¶"),  // 4
      C("7","‚ô£"),  // 5
      C("9","‚ô†"),  // 6
      C("J","‚ô£"),  // 7
      C("4","‚ô¶"),  // 8
      C("K","‚ô•")   // 9
    ],
    expected: [
      [0,1,2],   // run
      [3,4,5]    // set
    ]
  },

  // Add more tests here:
  // {
  //   name: "Test 2 ‚Äî Only Runs",
  //   hand: [...],
  //   expected: [...]
  // }

];
*/

function testMelds() {

    let message = "üÉè **Meld Unit Tests**\n\n";
    let passed = 0;
    let total = meldTests.length;
    
    // Normalizer so ordering doesn't break tests
  const normalize = arr =>
    arr.map(m => m.slice().sort((a,b)=>a-b))
       .sort((a,b)=>a[0]-b[0]);


  for (const t of meldTests) {

      
      
      
     const result = normalize(getAllMeldsv3(t.hand));

//      const result = normalize(getAllMeldsv2(t.hand));
//      console.log("my Result: ", result);
      
      const expected = normalize(t.expected);

    const pass = JSON.stringify(result) === JSON.stringify(expected);
      if (pass) passed++;
      
    message += `**${t.name}**\n`;
      message += `Hand: ${t.hand.map((c,i)=>`${i}) ${c.rank}${c.suit}`).join("  ")}  `;
    message += `Expected: ${JSON.stringify(expected)} ‚ûú `;
    message += `${JSON.stringify(result)} `;
    message += `${pass ? "‚úÖ" : "‚ùå"}**\n\n`;

   
  }

const pct = ((passed / total) * 100).toFixed(1);
    message += `----------------------------------------\n`;
    message += `Passed: ${passed} / ${total} (${pct}%)\n`;
    message += `----------------------------------------`;

  showMessage(message);
} // testMelds

// =========================
// TEST DEFINITIONS
// =========================
const meldTests = [

  // ---------------------------------------------------------
  // TEST 1 ‚Äî Run + Set (baseline)
  // ---------------------------------------------------------
  {
    name: "Test 1 ‚Äî Run + Set",
    hand: [
      C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô£"),
      C("7","‚ô•"), C("7","‚ô¶"), C("7","‚ô£"),
      C("9","‚ô†"), C("J","‚ô£"), C("4","‚ô¶"), C("K","‚ô•")
    ],
    expected: [
      [0,1,2],   // run
      [3,4,5]    // set
    ]
  },

  // ---------------------------------------------------------
  // TEST 2 ‚Äî Pure Run (4‚Äëcard run)
  // ---------------------------------------------------------
  {
    name: "Test 2 ‚Äî Pure Run (4 cards)",
    hand: [
      C("8","‚ô†"), C("9","‚ô†"), C("10","‚ô†"), C("J","‚ô†"),
      C("3","‚ô¶"), C("5","‚ô£"), C("7","‚ô•"), C("K","‚ô£"), C("4","‚ô£"), C("2","‚ô¶")
    ],
    expected: [
      [0,1,2,3]
    ]
  },

  // ---------------------------------------------------------
  // TEST 3 ‚Äî Pure Set (4‚Äëcard set)
  // ---------------------------------------------------------
  {
    name: "Test 3 ‚Äî Pure Set (4 cards)",
    hand: [
      C("9","‚ô£"), C("9","‚ô¶"), C("9","‚ô•"), C("9","‚ô†"),
      C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô¶"), C("4","‚ô•"), C("K","‚ô£"), C("7","‚ô¶")
    ],
    expected: [
      [0,1,2,3]
    ]
  },

  // ---------------------------------------------------------
  // TEST 4 ‚Äî Two Runs (same suit)
  // ---------------------------------------------------------
  {
    name: "Test 4 ‚Äî Two Runs",
    hand: [
      C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"),
      C("9","‚ô£"), C("10","‚ô£"), C("J","‚ô£"),
      C("2","‚ô¶"), C("7","‚ô•"), C("K","‚ô†"), C("3","‚ô¶")
    ],
    expected: [
      [0,1,2],
      [3,4,5]
    ]
  },

  // ---------------------------------------------------------
  // TEST 5 ‚Äî Two Sets
  // ---------------------------------------------------------
  {
    name: "Test 5 ‚Äî Two Sets",
    hand: [
      C("4","‚ô£"), C("4","‚ô¶"), C("4","‚ô•"),
      C("J","‚ô£"), C("J","‚ô¶"), C("J","‚ô•"),
      C("2","‚ô†"), C("5","‚ô£"), C("7","‚ô¶"), C("K","‚ô£")
    ],
    expected: [
      [0,1,2],
      [3,4,5]
    ]
  },

  // ---------------------------------------------------------
  // TEST 6 ‚Äî Overlapping Run (should choose longest)
  // ---------------------------------------------------------
  {
    name: "Test 6 ‚Äî Overlapping Run",
    hand: [
      C("5","‚ô†"), C("6","‚ô†"), C("7","‚ô†"), C("8","‚ô†"),
      C("2","‚ô¶"), C("3","‚ô£"), C("K","‚ô•"), C("9","‚ô£"), C("4","‚ô¶"), C("J","‚ô£")
    ],
    expected: [
      [0,1,2,3]
    ]
  },

  // ---------------------------------------------------------
  // TEST 7 ‚Äî Ace‚ÄëLow Run (A‚Äë2‚Äë3)
  // ---------------------------------------------------------
  {
    name: "Test 7 ‚Äî Ace‚ÄëLow Run",
    hand: [
      C("A","‚ô•"), C("2","‚ô•"), C("3","‚ô•"),
      C("9","‚ô£"), C("10","‚ô£"), C("J","‚ô£"),
      C("4","‚ô¶"), C("7","‚ô†"), C("K","‚ô£"), C("5","‚ô¶")
    ],
    expected: [
      [0,1,2]
    ]
  },

  // ---------------------------------------------------------
  // TEST 8 ‚Äî No Melds
  // ---------------------------------------------------------
  {
    name: "Test 8 ‚Äî No Melds",
    hand: [
      C("A","‚ô£"), C("3","‚ô¶"), C("5","‚ô£"), C("7","‚ô•"),
      C("9","‚ô†"), C("J","‚ô£"), C("K","‚ô¶"), C("4","‚ô£"),
      C("8","‚ô•"), C("2","‚ô†")
    ],
    expected: []
  },

  // ---------------------------------------------------------
  // TEST 9 ‚Äî Run appears only after removing set
  // ---------------------------------------------------------
  {
    name: "Test 9 ‚Äî Set first, then run",
    hand: [
      C("7","‚ô£"), C("7","‚ô¶"), C("7","‚ô•"),  // set
      C("4","‚ô†"), C("5","‚ô†"), C("6","‚ô†"),  // run
      C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
    ],
    expected: [
      [0,1,2],
      [3,4,5]
    ]
  },

  // ---------------------------------------------------------
  // TEST 10 ‚Äî Run appears only after removing 4‚Äëcard set
  // ---------------------------------------------------------
  {
    name: "Test 10 ‚Äî 4‚Äëcard set then run",
    hand: [
      C("8","‚ô£"), C("8","‚ô¶"), C("8","‚ô•"), C("8","‚ô†"),  // set
      C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô£"),              // run
      C("K","‚ô¶"), C("4","‚ô£"), C("9","‚ô•")
    ],
    expected: [
      [0,1,2,3],
      [4,5,6]
    ]
  },

  // ---------------------------------------------------------
  // TEST 11 ‚Äî Two possible runs, choose both
  // ---------------------------------------------------------
  {
    name: "Test 11 ‚Äî Two possible runs",
    hand: [
      C("3","‚ô¶"), C("4","‚ô¶"), C("5","‚ô¶"),
      C("9","‚ô•"), C("10","‚ô•"), C("J","‚ô•"),
      C("A","‚ô£"), C("7","‚ô†"), C("K","‚ô£"), C("2","‚ô†")
    ],
    expected: [
      [0,1,2],
      [3,4,5]
    ]
  },

  // ---------------------------------------------------------
  // TEST 12 ‚Äî Mixed tricky hand (run breaks and restarts)
  // ---------------------------------------------------------
  {
    name: "Test 12 ‚Äî Broken run",
    hand: [
      C("4","‚ô£"), C("5","‚ô£"), C("7","‚ô£"), C("8","‚ô£"), C("9","‚ô£"),
      C("2","‚ô¶"), C("3","‚ô¶"), C("K","‚ô†"), C("J","‚ô£"), C("10","‚ô£")
    ],
    expected: [
      [3,4,9],   // 8‚ô£, 9‚ô£, 10‚ô£
      [5,6]      // NOTE: 2‚ô¶,3‚ô¶ is NOT a run (only 2 cards)
    ].filter(m => m.length >= 3)
  },

  // ---------------------------------------------------------
  // TEST 13 ‚Äî Set + overlapping run (set wins first)
  // ---------------------------------------------------------
  {
    name: "Test 13 ‚Äî Set beats overlapping run",
    hand: [
      C("6","‚ô£"), C("6","‚ô¶"), C("6","‚ô•"),  // set
      C("5","‚ô£"), C("6","‚ô£"), C("7","‚ô£"),  // run but overlaps index 0
      C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
    ],
    expected: [
      [0,1,2]  // set only
    ]
  },
// ---------------------------------------------------------
// TEST 14 ‚Äî Longest run wins over multiple small runs
// ---------------------------------------------------------
{
  name: "Test 14 ‚Äî Longest run wins",
  hand: [
    C("4","‚ô†"), C("5","‚ô†"), C("6","‚ô†"), C("7","‚ô†"), C("8","‚ô†"),
    C("2","‚ô¶"), C("3","‚ô¶"), C("9","‚ô£"), C("J","‚ô•"), C("K","‚ô£")
  ],
  expected: [
    [0,1,2,3,4]
  ]
},

// ---------------------------------------------------------
// TEST 15 ‚Äî Two overlapping sets (only one valid)
// ---------------------------------------------------------
{
  name: "Test 15 ‚Äî Overlapping sets",
  hand: [
    C("Q","‚ô£"), C("Q","‚ô¶"), C("Q","‚ô•"),
    C("Q","‚ô†"), // 4‚Äëcard set
    C("Q","‚ô£"), // duplicate rank/suit impossible in real deck but tests robustness
    C("7","‚ô£"), C("8","‚ô¶"), C("9","‚ô•"), C("K","‚ô£"), C("A","‚ô¶")
  ],
  expected: [
    [0,1,2,3]   // only one set should be taken
  ]
},

// ---------------------------------------------------------
// TEST 16 ‚Äî Run with a gap in the middle (should break)
// ---------------------------------------------------------
{
  name: "Test 16 ‚Äî Broken run",
  hand: [
    C("4","‚ô•"), C("5","‚ô•"), C("7","‚ô•"), C("8","‚ô•"), C("9","‚ô•"),
    C("2","‚ô£"), C("3","‚ô£"), C("K","‚ô†"), C("J","‚ô£"), C("10","‚ô£")
  ],
  expected: [
    [3,4,9] // 8‚ô•, 9‚ô•, 10‚ô£ (mixed suits allowed? If not, expected = [])
  ]
},

// ---------------------------------------------------------
// TEST 17 ‚Äî Three runs in three suits
// ---------------------------------------------------------
{
  name: "Test 17 ‚Äî Three runs",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"),
    C("7","‚ô¶"), C("8","‚ô¶"), C("9","‚ô¶"),
    C("10","‚ô•"), C("J","‚ô•"), C("Q","‚ô•"),
    C("K","‚ô£")
  ],
  expected: [
    [0,1,2],
    [3,4,5],
    [6,7,8]
  ]
},

// ---------------------------------------------------------
// TEST 18 ‚Äî Set + run sharing a card (set wins)
// ---------------------------------------------------------
{
  name: "Test 18 ‚Äî Set beats run overlap",
  hand: [
    C("6","‚ô£"), C("6","‚ô¶"), C("6","‚ô•"), // set
    C("5","‚ô£"), C("6","‚ô£"), C("7","‚ô£"), // run overlaps index 0
    C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
  ],
  expected: [
    [0,1,2]
  ]
},

// ---------------------------------------------------------
// TEST 19 ‚Äî Run appears only after removing a different run
// ---------------------------------------------------------
{
  name: "Test 19 ‚Äî Cascading runs",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), // run 1
    C("6","‚ô£"), C("7","‚ô£"), C("8","‚ô£"), // run 2
    C("9","‚ô£"), C("J","‚ô¶"), C("Q","‚ô£"), C("K","‚ô£")
  ],
  expected: [
    [0,1,2],
    [3,4,5]
  ]
},

// ---------------------------------------------------------
// TEST 20 ‚Äî Ace cannot be high (Q‚ÄëK‚ÄëA invalid)
// ---------------------------------------------------------
{
  name: "Test 20 ‚Äî Ace not high",
  hand: [
    C("Q","‚ô£"), C("K","‚ô£"), C("A","‚ô£"),
    C("2","‚ô¶"), C("3","‚ô¶"), C("4","‚ô¶"),
    C("7","‚ô†"), C("9","‚ô£"), C("J","‚ô•"), C("5","‚ô£")
  ],
  expected: [
    [3,4,5] // only 2‚Äë3‚Äë4‚ô¶ is valid
  ]
},

// ---------------------------------------------------------
// TEST 21 ‚Äî Ace low run + normal run
// ---------------------------------------------------------
{
  name: "Test 21 ‚Äî Ace low + normal run",
  hand: [
    C("A","‚ô†"), C("2","‚ô†"), C("3","‚ô†"), // run 1
    C("9","‚ô•"), C("10","‚ô•"), C("J","‚ô•"), // run 2
    C("4","‚ô¶"), C("7","‚ô£"), C("K","‚ô£"), C("5","‚ô¶")
  ],
  expected: [
    [0,1,2],
    [3,4,5]
  ]
},

// ---------------------------------------------------------
// TEST 22 ‚Äî 5‚Äëcard set (should still be one meld)
// ---------------------------------------------------------
{
  name: "Test 22 ‚Äî 5‚Äëcard set",
  hand: [
    C("8","‚ô£"), C("8","‚ô¶"), C("8","‚ô•"), C("8","‚ô†"), C("8","‚ô£"),
    C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô¶"), C("4","‚ô•"), C("K","‚ô£")
  ],
  expected: [
    [0,1,2,3,4]
  ]
},

// ---------------------------------------------------------
// TEST 23 ‚Äî Multiple 4‚Äëcard runs
// ---------------------------------------------------------
{
  name: "Test 23 ‚Äî Two 4‚Äëcard runs",
  hand: [
    C("5","‚ô¶"), C("6","‚ô¶"), C("7","‚ô¶"), C("8","‚ô¶"),
    C("9","‚ô†"), C("10","‚ô†"), C("J","‚ô†"), C("Q","‚ô†"),
    C("A","‚ô£"), C("K","‚ô•")
  ],
  expected: [
    [0,1,2,3],
    [4,5,6,7]
  ]
},

// ---------------------------------------------------------
// TEST 24 ‚Äî Set + run + deadwood
// ---------------------------------------------------------
{
  name: "Test 24 ‚Äî Mixed hand",
  hand: [
    C("4","‚ô£"), C("4","‚ô¶"), C("4","‚ô•"), // set
    C("9","‚ô£"), C("10","‚ô£"), C("J","‚ô£"), // run
    C("2","‚ô¶"), C("5","‚ô£"), C("7","‚ô¶"), C("K","‚ô£")
  ],
  expected: [
    [0,1,2],
    [3,4,5]
  ]
},

// ---------------------------------------------------------
// TEST 25 ‚Äî Three sets
// ---------------------------------------------------------
{
  name: "Test 25 ‚Äî Three sets",
  hand: [
    C("3","‚ô£"), C("3","‚ô¶"), C("3","‚ô•"),
    C("9","‚ô£"), C("9","‚ô¶"), C("9","‚ô•"),
    C("K","‚ô£"), C("K","‚ô¶"), C("K","‚ô•"),
    C("A","‚ô£")
  ],
  expected: [
    [0,1,2],
    [3,4,5],
    [6,7,8]
  ]
},

// ---------------------------------------------------------
// TEST 26 ‚Äî Run with duplicate values (should ignore dupes)
// ---------------------------------------------------------
{
  name: "Test 26 ‚Äî Duplicate values in run",
  hand: [
    C("5","‚ô£"), C("5","‚ô¶"), // duplicate rank
    C("6","‚ô£"), C("7","‚ô£"), C("8","‚ô£"),
    C("2","‚ô¶"), C("3","‚ô£"), C("K","‚ô•"), C("J","‚ô£"), C("10","‚ô£")
  ],
  expected: [
    [2,3,4] // 6‚Äë7‚Äë8‚ô£
  ]
},

// ---------------------------------------------------------
// TEST 27 ‚Äî Run with mixed suits (invalid)
// ---------------------------------------------------------
{
  name: "Test 27 ‚Äî Mixed suit run invalid",
  hand: [
    C("4","‚ô£"), C("5","‚ô¶"), C("6","‚ô£"), // mixed suits
    C("7","‚ô£"), C("8","‚ô£"), C("9","‚ô£"),
    C("A","‚ô¶"), C("3","‚ô£"), C("K","‚ô•"), C("2","‚ô†")
  ],
  expected: [
    [3,4,5] // only 7‚Äë8‚Äë9‚ô£
  ]
},

// ---------------------------------------------------------
// TEST 28 ‚Äî Set appears only after removing run
// ---------------------------------------------------------
{
  name: "Test 28 ‚Äî Run first, then set",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), // run
    C("9","‚ô¶"), C("9","‚ô£"), C("9","‚ô•"), // set
    C("K","‚ô£"), C("2","‚ô¶"), C("7","‚ô•"), C("J","‚ô£")
  ],
  expected: [
    [0,1,2],
    [3,4,5]
  ]
},

// ---------------------------------------------------------
// TEST 29 ‚Äî No runs because of suit mismatch
// ---------------------------------------------------------
{
  name: "Test 29 ‚Äî Suit mismatch prevents run",
  hand: [
    C("8","‚ô£"), C("9","‚ô¶"), C("10","‚ô£"), C("J","‚ô£"),
    C("3","‚ô¶"), C("5","‚ô£"), C("7","‚ô•"), C("K","‚ô£"), C("4","‚ô£"), C("2","‚ô¶")
  ],
  expected: []
},

// ---------------------------------------------------------
// TEST 30 ‚Äî Long run with interruption at end
// ---------------------------------------------------------
{
  name: "Test 30 ‚Äî Interrupted long run",
  hand: [
    C("4","‚ô†"), C("5","‚ô†"), C("6","‚ô†"), C("7","‚ô†"), C("9","‚ô†"),
    C("2","‚ô¶"), C("3","‚ô¶"), C("K","‚ô£"), C("J","‚ô•"), C("10","‚ô£")
  ],
  expected: [
    [0,1,2,3]
  ]
},

// ---------------------------------------------------------
// TEST 31 ‚Äî Set of Aces
// ---------------------------------------------------------
{
  name: "Test 31 ‚Äî Ace set",
  hand: [
    C("A","‚ô£"), C("A","‚ô¶"), C("A","‚ô•"),
    C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"),
    C("9","‚ô†"), C("J","‚ô£"), C("4","‚ô¶"), C("K","‚ô•")
  ],
  expected: [
    [0,1,2],
    [3,4,5]
  ]
},

// ---------------------------------------------------------
// TEST 32 ‚Äî Run with Ace low only
// ---------------------------------------------------------
{
  name: "Test 32 ‚Äî Ace low only",
  hand: [
    C("A","‚ô¶"), C("2","‚ô¶"), C("3","‚ô¶"),
    C("Q","‚ô£"), C("K","‚ô£"), C("J","‚ô£"),
    C("4","‚ô£"), C("7","‚ô†"), C("9","‚ô•"), C("5","‚ô¶")
  ],
  expected: [
    [0,1,2]
  ]
},

// ---------------------------------------------------------
// TEST 33 ‚Äî Complex mixed hand (stress test)
// ---------------------------------------------------------
{
  name: "Test 33 ‚Äî Stress test",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), // run
    C("9","‚ô£"), C("9","‚ô¶"), C("9","‚ô•"), // set
    C("10","‚ô†"), C("J","‚ô†"), C("Q","‚ô†"), // run
    C("A","‚ô£")
  ],
  expected: [
    [0,1,2],
    [3,4,5],
    [6,7,8]
  ]
},

    

];


/*
  TESTING BEST COMBO and deadwood
*/

function testBestCombos() {
    
    let message = "üî• Best Combo + Deadwood Tests\n\n";
    let passed = 0;
    let total = bestComboTests.length;
    
    const normalize = arr =>
    arr.map(m => m.slice().sort((a,b)=>a-b))
       .sort((a,b)=>a[0]-b[0]);

  for (const t of bestComboTests) {

    const result = bestMeldCombo(t.hand);

    const meldsNorm = normalize(result.melds);
    const expectedNorm = normalize(t.expectedMelds);

    const meldsPass = JSON.stringify(meldsNorm) === JSON.stringify(expectedNorm);
      const deadwoodPass = result.deadwood === t.expectedDeadwood;
      const pass = meldsPass && deadwoodPass;
      if (pass) passed++;

      message += `**${t.name}**\n`;
      message += `Hand: ${t.hand.map((c,i)=>`${i}) ${c.rank}${c.suit}`).join("  ")}\n`;
    message += `Expected melds: ${JSON.stringify(expectedNorm)} ‚ûú `;
    message += `Got melds: ${JSON.stringify(meldsNorm)}\n`;
    message += `Expected deadwood: ${t.expectedDeadwood} ‚ûú `;
    message += `Got: ${result.deadwood}  `;
    message += `**${(meldsPass && deadwoodPass) ? "‚úÖ" : "‚ùå"}**\n\n`;
  }

    const pct = ((passed / total) * 100).toFixed(1);
    message += `----------------------------------------\n`;
    message += `Passed: ${passed} / ${total} (${pct}%)\n`;
    message += `----------------------------------------`;

    
  showMessage(message);
}

const bestComboTests = [

  // ---------------------------------------------------------
  // BC1 ‚Äî Run + Set (baseline)
  // ---------------------------------------------------------
  {
    name: "BC1 ‚Äî Run + Set",
    hand: [
      C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô£"),   // run
      C("7","‚ô•"), C("7","‚ô¶"), C("7","‚ô£"),   // set
      C("9","‚ô†"), C("J","‚ô£"), C("4","‚ô¶"), C("K","‚ô•")
    ],
    expectedMelds: [
      [0,1,2],
      [3,4,5]
    ],
    expectedDeadwood: 9 + 10 + 4 + 10 // = 33
  },

  // ---------------------------------------------------------
  // BC2 ‚Äî Only a run
  // ---------------------------------------------------------
  {
    name: "BC2 ‚Äî Only run",
    hand: [
      C("8","‚ô†"), C("9","‚ô†"), C("10","‚ô†"), C("J","‚ô†"),
      C("3","‚ô¶"), C("5","‚ô£"), C("7","‚ô•"), C("K","‚ô£"), C("4","‚ô£"), C("2","‚ô¶")
    ],
    expectedMelds: [
      [0,1,2,3]
    ],
    expectedDeadwood: 3 + 5 + 7 + 10 + 4 + 2 // = 31
  },

  // ---------------------------------------------------------
  // BC3 ‚Äî Only a set
  // ---------------------------------------------------------
  {
    name: "BC3 ‚Äî Only set",
    hand: [
      C("9","‚ô£"), C("9","‚ô¶"), C("9","‚ô•"),   // set
      C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô¶"), C("4","‚ô•"), C("K","‚ô£"), C("7","‚ô¶"), C("5","‚ô£")
    ],
    expectedMelds: [
      [0,1,2]
    ],
    expectedDeadwood: 1 + 2 + 3 + 4 + 10 + 7 + 5 // = 32
  },

  // ---------------------------------------------------------
  // BC4 ‚Äî Two runs
  // ---------------------------------------------------------
  {
    name: "BC4 ‚Äî Two runs",
    hand: [
      C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"),   // run 1
      C("9","‚ô£"), C("10","‚ô£"), C("J","‚ô£"),  // run 2
      C("2","‚ô¶"), C("7","‚ô•"), C("K","‚ô†"), C("3","‚ô¶")
    ],
    expectedMelds: [
      [0,1,2],
      [3,4,5]
    ],
    expectedDeadwood: 2 + 7 + 10 + 3 // = 22
  },

  // ---------------------------------------------------------
  // BC5 ‚Äî Two sets
  // ---------------------------------------------------------
  {
    name: "BC5 ‚Äî Two sets",
    hand: [
      C("4","‚ô£"), C("4","‚ô¶"), C("4","‚ô•"),   // set 1
      C("J","‚ô£"), C("J","‚ô¶"), C("J","‚ô•"),   // set 2
      C("2","‚ô†"), C("5","‚ô£"), C("7","‚ô¶"), C("K","‚ô£")
    ],
    expectedMelds: [
      [0,1,2],
      [3,4,5]
    ],
    expectedDeadwood: 2 + 5 + 7 + 10 // = 24
  },

  // ---------------------------------------------------------
  // BC6 ‚Äî Overlapping run (longest wins)
  // ---------------------------------------------------------
  {
    name: "BC6 ‚Äî Longest run wins",
    hand: [
      C("5","‚ô†"), C("6","‚ô†"), C("7","‚ô†"), C("8","‚ô†"),
      C("2","‚ô¶"), C("3","‚ô£"), C("K","‚ô•"), C("9","‚ô£"), C("4","‚ô¶"), C("J","‚ô£")
    ],
    expectedMelds: [
      [0,1,2,3]
    ],
    expectedDeadwood: 2 + 3 + 10 + 9 + 4 + 10 // = 38
  },

  // ---------------------------------------------------------
  // BC7 ‚Äî Ace‚Äëlow run + normal run
  // ---------------------------------------------------------
  {
    name: "BC7 ‚Äî Ace low + normal run",
    hand: [
      C("A","‚ô†"), C("2","‚ô†"), C("3","‚ô†"),   // run 1
      C("9","‚ô•"), C("10","‚ô•"), C("J","‚ô•"),  // run 2
      C("4","‚ô¶"), C("7","‚ô£"), C("K","‚ô£"), C("5","‚ô¶")
    ],
    expectedMelds: [
      [0,1,2],
      [3,4,5]
    ],
    expectedDeadwood: 4 + 7 + 10 + 5 // = 26
  },

  // ---------------------------------------------------------
  // BC8 ‚Äî No melds at all
  // ---------------------------------------------------------
  {
    name: "BC8 ‚Äî No melds",
    hand: [
      C("A","‚ô£"), C("3","‚ô¶"), C("5","‚ô£"), C("7","‚ô•"),
      C("9","‚ô†"), C("J","‚ô£"), C("K","‚ô¶"), C("4","‚ô£"),
      C("8","‚ô•"), C("2","‚ô†")
    ],
    expectedMelds: [],
    expectedDeadwood:
      1 + 3 + 5 + 7 + 9 + 10 + 10 + 4 + 8 + 2 // = 59
  },

  // ---------------------------------------------------------
  // BC9 ‚Äî Set first, then run
  // ---------------------------------------------------------
  {
    name: "BC9 ‚Äî Set then run",
    hand: [
      C("7","‚ô£"), C("7","‚ô¶"), C("7","‚ô•"),   // set
      C("4","‚ô†"), C("5","‚ô†"), C("6","‚ô†"),   // run
      C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
    ],
    expectedMelds: [
      [0,1,2],
      [3,4,5]
    ],
    expectedDeadwood: 10 + 2 + 9 + 3 // = 24
  },

  // ---------------------------------------------------------
  // BC10 ‚Äî 4‚Äëcard set + run
  // ---------------------------------------------------------
  {
    name: "BC10 ‚Äî 4‚Äëcard set + run",
    hand: [
      C("8","‚ô£"), C("8","‚ô¶"), C("8","‚ô•"), C("8","‚ô†"), // set
      C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô£"),             // run
      C("K","‚ô¶"), C("4","‚ô£"), C("9","‚ô•")
    ],
    expectedMelds: [
      [0,1,2,3],
      [4,5,6]
    ],
    expectedDeadwood: 10 + 4 + 9 // = 23
  },
    
// ---------------------------------------------------------
// BC11 ‚Äî Two possible combos, one has lower deadwood
// ---------------------------------------------------------
{
  name: "BC11 ‚Äî Choose lower-deadwood combo",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"),   // run
    C("3","‚ô¶"), C("3","‚ô•"), C("9","‚ô†"),   // set option
    C("K","‚ô£"), C("2","‚ô¶"), C("7","‚ô•"), C("J","‚ô£")
  ],
  expectedMelds: [
    [0,1,2],       // run is better than set
  ],
  expectedDeadwood: 3 + 9 + 10 + 2 + 7 + 10 // = 41
},

// ---------------------------------------------------------
// BC12 ‚Äî Set produces lower deadwood than run
// ---------------------------------------------------------
{
  name: "BC12 ‚Äî Set beats run for deadwood",
  hand: [
    C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"),   // run option
    C("6","‚ô¶"), C("6","‚ô•"), C("6","‚ô†"),   // set option
    C("A","‚ô£"), C("K","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
  ],
  expectedMelds: [
    [3,4,5]        // set chosen
  ],
  expectedDeadwood: 4 + 5 + 6 + 1 + 10 + 9 + 3 // = 38
},

// ---------------------------------------------------------
// BC13 ‚Äî Two runs overlap; choose non-overlapping pair
// ---------------------------------------------------------
{
  name: "BC13 ‚Äî Overlapping runs, choose valid pair",
  hand: [
    C("5","‚ô†"), C("6","‚ô†"), C("7","‚ô†"), C("8","‚ô†"), // long run
    C("6","‚ô¶"), C("7","‚ô¶"), C("8","‚ô¶"),             // second run
    C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•")
  ],
  expectedMelds: [
    [0,1,2,3],     // long run only
    [4,5,6]        // second run
  ],
  expectedDeadwood: 10 + 2 + 9 // = 21
},

// ---------------------------------------------------------
// BC14 ‚Äî Best combo is NOT the longest run
// ---------------------------------------------------------
{
  name: "BC14 ‚Äî Shorter run + set beats long run",
  hand: [
    C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"), C("7","‚ô£"), // long run
    C("7","‚ô¶"), C("7","‚ô•"), C("7","‚ô†"),             // set
    C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•")
  ],
  expectedMelds: [
    [4,5,6],       // set
    [0,1,2]        // shorter run
  ],
  expectedDeadwood: 7 + 10 + 2 + 9 // = 28
},

// ---------------------------------------------------------
// BC15 ‚Äî Ace-low run only (A-2-3)
// ---------------------------------------------------------
{
  name: "BC15 ‚Äî Ace-low only",
  hand: [
    C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô£"),
    C("Q","‚ô¶"), C("K","‚ô¶"), C("J","‚ô¶"),
    C("4","‚ô£"), C("7","‚ô†"), C("9","‚ô•"), C("5","‚ô¶")
  ],
  expectedMelds: [
    [0,1,2]
  ],
  expectedDeadwood: 10 + 10 + 10 + 4 + 7 + 9 + 5 // = 55
},

// ---------------------------------------------------------
// BC16 ‚Äî Two sets + run
// ---------------------------------------------------------
{
  name: "BC16 ‚Äî Two sets + run",
  hand: [
    C("3","‚ô£"), C("3","‚ô¶"), C("3","‚ô•"),   // set 1
    C("9","‚ô£"), C("9","‚ô¶"), C("9","‚ô•"),   // set 2
    C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"),   // run
    C("K","‚ô£")
  ],
  expectedMelds: [
    [0,1,2],
    [3,4,5],
    [6,7,8]
  ],
  expectedDeadwood: 10
},

// ---------------------------------------------------------
// BC17 ‚Äî Only one of two sets can be taken (overlap)
// ---------------------------------------------------------
{
  name: "BC17 ‚Äî Overlapping sets",
  hand: [
    C("8","‚ô£"), C("8","‚ô¶"), C("8","‚ô•"),   // set 1
    C("8","‚ô†"), C("8","‚ô£"),               // overlapping
    C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô¶"), C("4","‚ô•"), C("K","‚ô£")
  ],
  expectedMelds: [
    [0,1,2,3]     // only one set
  ],
  expectedDeadwood: 1 + 2 + 3 + 4 + 10 // = 20
},

// ---------------------------------------------------------
// BC18 ‚Äî Best combo is two short runs, not one long run
// ---------------------------------------------------------
{
  name: "BC18 ‚Äî Two short runs beat long run",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"), // long run
    C("9","‚ô¶"), C("10","‚ô¶"), C("J","‚ô¶"),            // run 2
    C("A","‚ô£"), C("2","‚ô£"), C("7","‚ô•")
  ],
  expectedMelds: [
    [0,1,2],       // short run
    [4,5,6]        // second run
  ],
  expectedDeadwood: 6 + 1 + 2 + 7 // = 16
},

// ---------------------------------------------------------
// BC19 ‚Äî Set appears only after removing run
// ---------------------------------------------------------
{
  name: "BC19 ‚Äî Run enables set",
  hand: [
    C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"), // run
    C("6","‚ô¶"), C("6","‚ô•"), C("6","‚ô†"), // set
    C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
  ],
  expectedMelds: [
    [0,1,2],
    [3,4,5]
  ],
  expectedDeadwood: 10 + 2 + 9 + 3 // = 24
},

// ---------------------------------------------------------
// BC20 ‚Äî Set enables run
// ---------------------------------------------------------
{
  name: "BC20 ‚Äî Set enables run",
  hand: [
    C("7","‚ô£"), C("7","‚ô¶"), C("7","‚ô•"), // set
    C("8","‚ô£"), C("9","‚ô£"), C("10","‚ô£"), // run
    C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
  ],
  expectedMelds: [
    [0,1,2],
    [3,4,5]
  ],
  expectedDeadwood: 10 + 2 + 9 + 3 // = 24
},

// ---------------------------------------------------------
// BC21 ‚Äî No melds, high deadwood
// ---------------------------------------------------------
{
  name: "BC21 ‚Äî No melds high deadwood",
  hand: [
    C("K","‚ô£"), C("Q","‚ô¶"), C("J","‚ô•"), C("10","‚ô£"),
    C("9","‚ô¶"), C("8","‚ô£"), C("7","‚ô•"), C("6","‚ô†"),
    C("5","‚ô¶"), C("4","‚ô£")
  ],
  expectedMelds: [],
  expectedDeadwood: 10+10+10+10+9+8+7+6+5+4 // = 79
},

// ---------------------------------------------------------
// BC22 ‚Äî Mixed suits prevent run
// ---------------------------------------------------------
{
  name: "BC22 ‚Äî Suit mismatch prevents run",
  hand: [
    C("4","‚ô£"), C("5","‚ô¶"), C("6","‚ô£"), C("7","‚ô£"),
    C("8","‚ô£"), C("9","‚ô£"), C("A","‚ô¶"), C("3","‚ô£"),
    C("K","‚ô•"), C("2","‚ô†")
  ],
  expectedMelds: [
    [3,4,5] // 7-8-9‚ô£
  ],
  expectedDeadwood: 4 + 5 + 1 + 3 + 10 + 2 // = 25
},

// ---------------------------------------------------------
// BC23 ‚Äî 5-card run + set
// ---------------------------------------------------------
{
  name: "BC23 ‚Äî 5-card run + set",
  hand: [
    C("4","‚ô†"), C("5","‚ô†"), C("6","‚ô†"), C("7","‚ô†"), C("8","‚ô†"), // run
    C("Q","‚ô£"), C("Q","‚ô¶"), C("Q","‚ô•"),                         // set
    C("A","‚ô£"), C("3","‚ô¶")
  ],
  expectedMelds: [
    [0,1,2,3,4],
    [5,6,7]
  ],
  expectedDeadwood: 1 + 3 // = 4
},

// ---------------------------------------------------------
// BC24 ‚Äî 5-card set + run
// ---------------------------------------------------------
{
  name: "BC24 ‚Äî 5-card set + run",
  hand: [
    C("9","‚ô£"), C("9","‚ô¶"), C("9","‚ô•"), C("9","‚ô†"), C("9","‚ô£"), // set
    C("A","‚ô£"), C("2","‚ô£"), C("3","‚ô£"),                         // run
    C("K","‚ô¶"), C("4","‚ô£")
  ],
  expectedMelds: [
    [0,1,2,3,4],
    [5,6,7]
  ],
  expectedDeadwood: 10 + 4 // = 14
},

// ---------------------------------------------------------
// BC25 ‚Äî Best combo is set + run, not two runs
// ---------------------------------------------------------
{
  name: "BC25 ‚Äî Set + run beats two runs",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), // run 1
    C("5","‚ô¶"), C("5","‚ô•"), C("5","‚ô†"), // set
    C("6","‚ô£"), C("7","‚ô£"), C("8","‚ô£"), // run 2
    C("K","‚ô£")
  ],
  expectedMelds: [
    [3,4,5],     // set
    [6,7,8]      // run
  ],
  expectedDeadwood: 3 + 4 + 5 + 10 // = 22
},

// ---------------------------------------------------------
// BC26 ‚Äî Best combo is long run only
// ---------------------------------------------------------
{
  name: "BC26 ‚Äî Long run only",
  hand: [
    C("2","‚ô£"), C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"),
    C("9","‚ô¶"), C("J","‚ô£"), C("K","‚ô£"), C("7","‚ô•"), C("A","‚ô¶")
  ],
  expectedMelds: [
    [0,1,2,3,4]
  ],
  expectedDeadwood: 9 + 10 + 10 + 7 + 1 // = 37
},

// ---------------------------------------------------------
// BC27 ‚Äî Best combo is two sets
// ---------------------------------------------------------
{
  name: "BC27 ‚Äî Two sets",
  hand: [
    C("4","‚ô£"), C("4","‚ô¶"), C("4","‚ô•"),
    C("J","‚ô£"), C("J","‚ô¶"), C("J","‚ô•"),
    C("A","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
  ],
  expectedMelds: [
    [0,1,2],
    [3,4,5]
  ],
  expectedDeadwood: 1 + 2 + 9 + 3 // = 15
},

// ---------------------------------------------------------
// BC28 ‚Äî Best combo is run + run + set
// ---------------------------------------------------------
{
  name: "BC28 ‚Äî Run + run + set",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), // run 1
    C("7","‚ô¶"), C("8","‚ô¶"), C("9","‚ô¶"), // run 2
    C("K","‚ô£"), C("K","‚ô¶"), C("K","‚ô•"), // set
    C("A","‚ô£")
  ],
  expectedMelds: [
    [0,1,2],
    [3,4,5],
    [6,7,8]
  ],
  expectedDeadwood: 1
},

// ---------------------------------------------------------
// BC29 ‚Äî Best combo is run, not set
// ---------------------------------------------------------
{
  name: "BC29 ‚Äî Run beats set",
  hand: [
    C("6","‚ô£"), C("6","‚ô¶"), C("6","‚ô•"), // set option
    C("4","‚ô£"), C("5","‚ô£"), C("6","‚ô£"), // run option
    C("K","‚ô£"), C("2","‚ô¶"), C("9","‚ô•"), C("3","‚ô£")
  ],
  expectedMelds: [
    [3,4,5]
  ],
  expectedDeadwood: 6 + 10 + 2 + 9 + 3 // = 30
},

// ---------------------------------------------------------
// BC30 ‚Äî Stress test: multiple overlapping melds
// ---------------------------------------------------------
{
  name: "BC30 ‚Äî Overlapping stress test",
  hand: [
    C("3","‚ô£"), C("4","‚ô£"), C("5","‚ô£"), // run
    C("3","‚ô¶"), C("3","‚ô•"), C("3","‚ô†"), // set
    C("4","‚ô¶"), C("5","‚ô¶"), C("6","‚ô¶"), // second run
    C("K","‚ô£")
  ],
  expectedMelds: [
    [3,4,5],     // set
    [6,7,8]      // run
  ],
  expectedDeadwood: 3 + 4 + 5 + 10 // = 22
}

];
